# coding: utf-8

# Этот скрипт добавляет экран выбора языка, полностью совместимый с Ren'Py 7.4.11.

# --- Шаг 1: Инициализация переменной для хранения языка ---
# Используем `default`, чтобы избежать ошибок при первом запуске игры,
# когда `persistent.language` еще не был задан.
# `None` соответствует языку по умолчанию (английскому).
default persistent.language = None


# --- Шаг 2: Создание экрана выбора языка ---
screen language_screen():
    # Используем стандартный шаблон `navigation` для единообразного вида.
    # Это создаст навигационное меню слева и заголовок сверху.
    tag menu
    use navigation

    # Вертикальный блок для размещения кнопок выбора языка.
    vbox:
        # Отступы, чтобы кнопки не прилипали к краям.
        xalign 0.5
        yalign 0.5
        spacing 10

        # --- Кнопки для выбора языка ---

        # Кнопка для английского языка.
        textbutton "English":
            action Language(None)
            # `selected_` подсвечивает кнопку, если условие истинно.
            # В данном случае, если текущий язык — английский (`None`).
            selected_ (persistent.language == None)

        # Кнопка для русского языка.
        textbutton "Русский":
            action Language("russian")
            selected_ (persistent.language == "russian")


# --- Шаг 3: Добавление кнопки в игровое меню (подход для Ren'Py 7) ---
init python:
    # В Ren'Py 7 для добавления нового пункта в меню используется
    # изменение списка `config.game_menu`.
    # Добавляем кортеж: (Надпись, Действие, Условие показа).
    # "language_screen" — это имя экрана, который мы определили выше.
    config.game_menu.append(
        (_("Language"), "language_screen", "True")
    )


# --- Шаг 4: Перевод строк на русский язык ---
translate russian strings:
    # Перевод надписи для кнопки в главном меню.
    "Language": "Язык"

    # Ren'Py автоматически использует заголовок из `config.game_menu`
    # для экрана `language_screen`, поэтому отдельный перевод заголовка не нужен.

    # Кнопка "Return" (Возврат) добавляется автоматически через `use navigation`,
    # и её перевод уже должен быть в вашем `common.rpy`. Если его нет,
    # Ren'Py использует стандартный перевод.
